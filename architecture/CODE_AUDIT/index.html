
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Engineering Team">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Code Security Auditor - {{ project_name }}</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#code-security-auditor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="{{ project_name }}" class="md-header__button md-logo" aria-label="{{ project_name }}" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            {{ project_name }}
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Code Security Auditor
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  In√≠cio

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/testing/" class="md-tabs__link">
          
  
  
  Guias

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/git_sync/" class="md-tabs__link">
          
  
  
  Refer√™ncia da API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="{{ project_name }}" class="md-nav__button md-logo" aria-label="{{ project_name }}" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    {{ project_name }}
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    In√≠cio
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guias
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guias
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filosofia de Testes
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Refer√™ncia da API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Refer√™ncia da API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/git_sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Git Sync
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--active"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#arquitetura-modular-solid" class="md-nav__link">
    <span class="md-ellipsis">
      
        üèóÔ∏è Arquitetura Modular S.O.L.I.D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üèóÔ∏è Arquitetura Modular S.O.L.I.D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visao-geral-da-evolucao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vis√£o Geral da Evolu√ß√£o
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principios-aplicados" class="md-nav__link">
    <span class="md-ellipsis">
      
        Princ√≠pios Aplicados
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Princ√≠pios Aplicados">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-single-responsibility-principle-srp" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Single Responsibility Principle (SRP)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-openclosed-principle-ocp" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Open/Closed Principle (OCP)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-dependency-inversion-principle-dip" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Dependency Inversion Principle (DIP)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modulos-principais" class="md-nav__link">
    <span class="md-ellipsis">
      
        M√≥dulos Principais
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="M√≥dulos Principais">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modelspy-camada-de-dados" class="md-nav__link">
    <span class="md-ellipsis">
      
        üì¶ models.py - Camada de Dados
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configpy-gerenciador-de-configuracao" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚öôÔ∏è config.py - Gerenciador de Configura√ß√£o
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scannerpy-motor-de-descoberta" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîç scanner.py - Motor de Descoberta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzerpy-cerebro-da-analise" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß† analyzer.py - C√©rebro da An√°lise
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reporterpy-formatador-de-relatorios" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìä reporter.py - Formatador de Relat√≥rios
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pluginspy-sistema-de-extensibilidade" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîå plugins.py - Sistema de Extensibilidade
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fluxo-de-execucao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fluxo de Execu√ß√£o
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beneficios-da-modularizacao" class="md-nav__link">
    <span class="md-ellipsis">
      
        Benef√≠cios da Modulariza√ß√£o
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#referencias-tecnicas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Refer√™ncias T√©cnicas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîç Features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        üöÄ Quick Start
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üöÄ Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-patterns-detected" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìã Security Patterns Detected
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìã Security Patterns Detected">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#critical-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Critical Severity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        High Severity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medium-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Medium Severity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#low-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Low Severity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#catalogo-de-plugins-disponiveis" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîå Cat√°logo de Plugins Dispon√≠veis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîå Cat√°logo de Plugins Dispon√≠veis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plugin-check_mock_coverage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plugin: check_mock_coverage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plugin-simulate_ci" class="md-nav__link">
    <span class="md-ellipsis">
      
        Plugin: simulate_ci
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#desenvolvendo-novos-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Desenvolvendo Novos Plugins
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚öôÔ∏è Configuration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#report-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìä Report Format
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîß Command Line Options
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#devops-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        üèóÔ∏è DevOps Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üèóÔ∏è DevOps Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cicd-pipeline-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD Pipeline Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Docker Integration
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      
        üõ°Ô∏è Security Best Practices
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìà Performance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#itens-auditados-e-resolvidos" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîê Itens Auditados e Resolvidos
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîê Itens Auditados e Resolvidos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p002-atomicidade-do-pip-install" class="md-nav__link">
    <span class="md-ellipsis">
      
        [P00.2] Atomicidade do Pip Install
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      
        ü§ù Contributing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìö Dependencies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîç Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîç Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Issues
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìû Support
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#historico-de-melhorias" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìã Hist√≥rico de Melhorias
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìã Hist√≥rico de Melhorias">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#p29-hardening-de-dados-com-enums" class="md-nav__link">
    <span class="md-ellipsis">
      
        [P29] Hardening de Dados com Enums
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="code-security-auditor">Code Security Auditor</h1>
<p>Enterprise-grade security and quality auditing tool for Python projects. This tool performs static analysis to detect security vulnerabilities, external dependencies, and potential CI/CD issues before code commits.</p>
<blockquote>
<p><strong>Arquitetura:</strong> Sistema modular seguindo princ√≠pios S.O.L.I.D., refatorado de mon√≥lito de 700+ linhas para pacote com responsabilidades segregadas.</p>
<p><strong>Arquitetura:</strong> Sistema modular seguindo princ√≠pios S.O.L.I.D., refatorado de mon√≥lito de 700+ linhas para pacote com responsabilidades segregadas.</p>
</blockquote>
<h2 id="arquitetura-modular-solid">üèóÔ∏è Arquitetura Modular S.O.L.I.D</h2>
<h3 id="visao-geral-da-evolucao">Vis√£o Geral da Evolu√ß√£o</h3>
<p>O sistema de auditoria foi completamente refatorado (Sprint P12) de um mon√≥lito √∫nico (<code>code_audit.py</code>, 700+ linhas) para uma arquitetura modular seguindo princ√≠pios <strong>S.O.L.I.D.</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>scripts/audit/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>‚îú‚îÄ‚îÄ __init__.py
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>‚îú‚îÄ‚îÄ models.py         # üì¶ Data models (Pydantic/Dataclasses)
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>‚îú‚îÄ‚îÄ config.py         # ‚öôÔ∏è  YAML configuration loader
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>‚îú‚îÄ‚îÄ scanner.py        # üîç File discovery engine
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>‚îú‚îÄ‚îÄ analyzer.py       # üß† Security pattern analyzer
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>‚îú‚îÄ‚îÄ reporter.py       # üìä Report generation (JSON/YAML)
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>‚îî‚îÄ‚îÄ plugins.py        # üîå Extensibility system
</code></pre></div>
<h3 id="principios-aplicados">Princ√≠pios Aplicados</h3>
<h4 id="1-single-responsibility-principle-srp">1. Single Responsibility Principle (SRP)</h4>
<p>Cada m√≥dulo possui <strong>uma √∫nica raz√£o para mudar</strong>:</p>
<ul>
<li><strong><code>models.py</code></strong>: Representa estruturas de dados (AuditResult, SecurityPattern)</li>
<li><strong><code>config.py</code></strong>: Carrega e valida configura√ß√£o YAML</li>
<li><strong><code>scanner.py</code></strong>: Descobre arquivos Python no workspace</li>
<li><strong><code>analyzer.py</code></strong>: Detecta padr√µes de seguran√ßa no c√≥digo</li>
<li><strong><code>reporter.py</code></strong>: Formata e escreve relat√≥rios</li>
<li><strong><code>plugins.py</code></strong>: An√°lises especializadas (mock coverage, CI simulation)</li>
</ul>
<h4 id="2-openclosed-principle-ocp">2. Open/Closed Principle (OCP)</h4>
<p>O sistema √© <strong>aberto para extens√£o</strong> (via plugins) mas <strong>fechado para modifica√ß√£o</strong> (core est√°vel):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Extens√£o sem modificar o core</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scripts.audit.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_mock_coverage</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Novo plugin customizado</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_sql_injection</span><span class="p">(</span><span class="n">workspace_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="c1"># Implementa√ß√£o customizada</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="k">pass</span>
</code></pre></div>
<h4 id="3-dependency-inversion-principle-dip">3. Dependency Inversion Principle (DIP)</h4>
<p>Componentes dependem de abstra√ß√µes (<code>FileSystemAdapter</code>), n√£o de implementa√ß√µes concretas:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># analyzer.py e scanner.py usam abstra√ß√£o</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">CodeAnalyzer</span><span class="p">:</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs_adapter</span><span class="p">:</span> <span class="n">FileSystemAdapter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs_adapter</span> <span class="ow">or</span> <span class="n">RealFileSystem</span><span class="p">()</span>  <span class="c1"># DI padr√£o</span>
</code></pre></div>
<p>Isso permite <strong>testes unit√°rios sem I/O real</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Testes com filesystem mockado</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scripts.utils.filesystem</span><span class="w"> </span><span class="kn">import</span> <span class="n">InMemoryFileSystem</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">mock_fs</span> <span class="o">=</span> <span class="n">InMemoryFileSystem</span><span class="p">({</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;script.py&quot;</span><span class="p">):</span> <span class="s2">&quot;import os</span><span class="se">\n</span><span class="s2">os.system(&#39;rm -rf /&#39;)&quot;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="p">})</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">CodeAnalyzer</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="n">workspace</span><span class="p">,</span> <span class="n">fs_adapter</span><span class="o">=</span><span class="n">mock_fs</span><span class="p">)</span>
</code></pre></div>
<h3 id="modulos-principais">M√≥dulos Principais</h3>
<h4 id="modelspy-camada-de-dados">üì¶ <code>models.py</code> - Camada de Dados</h4>
<p>Define estruturas de dados tipadas e validadas:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecuritySeverity</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Severity levels (Enum para type safety).&quot;&quot;&quot;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;LOW&quot;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;MEDIUM&quot;</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;HIGH&quot;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;CRITICAL&quot;</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecurityPattern</span><span class="p">:</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Padr√£o de seguran√ßa configur√°vel.&quot;&quot;&quot;</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    <span class="n">pattern</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="n">severity</span><span class="p">:</span> <span class="n">SecuritySeverity</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    <span class="n">suggestion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="nd">@dataclass</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuditResult</span><span class="p">:</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Resultado de uma an√°lise.&quot;&quot;&quot;</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    <span class="n">line</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="n">severity</span><span class="p">:</span> <span class="n">SecuritySeverity</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>    <span class="n">suggestion</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
<p><strong>Responsabilidade:</strong> Garantir integridade de dados (imutabilidade com <code>frozen=True</code>, valida√ß√£o com Enums).</p>
<h4 id="configpy-gerenciador-de-configuracao">‚öôÔ∏è <code>config.py</code> - Gerenciador de Configura√ß√£o</h4>
<p>Carrega e valida <code>audit_config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AuditConfig</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Carregador robusto de configura√ß√£o YAML.&quot;&quot;&quot;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Load and validate YAML configuration.&quot;&quot;&quot;</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>        <span class="c1"># Valida√ß√µes:</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>        <span class="c1"># 1. Arquivo existe?</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        <span class="c1"># 2. YAML v√°lido?</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="c1"># 3. Campos obrigat√≥rios presentes?</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="c1"># 4. Valores dentro de limites aceit√°veis?</span>
</code></pre></div>
<p><strong>Valida√ß√µes Implementadas:</strong></p>
<ul>
<li>‚úÖ Exist√™ncia do arquivo de configura√ß√£o</li>
<li>‚úÖ Sintaxe YAML v√°lida</li>
<li>‚úÖ Campos obrigat√≥rios (<code>scan_paths</code>, <code>file_patterns</code>)</li>
<li>‚úÖ Valores padr√£o seguros (<code>ci_timeout: 300</code>, <code>max_findings_per_file: 50</code>)</li>
</ul>
<h4 id="scannerpy-motor-de-descoberta">üîç <code>scanner.py</code> - Motor de Descoberta</h4>
<p>Varre o workspace para encontrar arquivos Python:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">FileScanner</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Descobre arquivos Python respeitando regras de exclus√£o.&quot;&quot;&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retorna lista de arquivos Python encontrados.&quot;&quot;&quot;</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>        <span class="c1"># 1. Itera sobre scan_paths (ex: [&#39;src/&#39;, &#39;tests/&#39;, &#39;scripts/&#39;])</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        <span class="c1"># 2. Aplica file_patterns (ex: [&#39;*.py&#39;])</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>        <span class="c1"># 3. Filtra exclude_paths (ex: [&#39;.venv/&#39;, &#39;__pycache__/&#39;])</span>
</code></pre></div>
<p><strong>Pontos de Aten√ß√£o:</strong></p>
<ul>
<li><strong>Cobertura Total:</strong> N√£o ignora <code>scripts/</code> ou <code>.github/</code> (problema resolvido na P10).</li>
<li><strong>Globbing Recursivo:</strong> Usa <code>**/*.py</code> para varrer subdiret√≥rios.</li>
<li><strong>Filtro de Exclus√£o:</strong> Evita varrer <code>.venv/</code>, <code>__pycache__/</code>, <code>.git/</code>.</li>
</ul>
<p><strong>Exemplo de Uso:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">scanner</span> <span class="o">=</span> <span class="n">FileScanner</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">workspace_root</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">(),</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="n">scan_paths</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;src/&quot;</span><span class="p">,</span> <span class="s2">&quot;tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;scripts/&quot;</span><span class="p">],</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">file_patterns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*.py&quot;</span><span class="p">],</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">exclude_paths</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;.venv/&quot;</span><span class="p">,</span> <span class="s2">&quot;__pycache__/&quot;</span><span class="p">]</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">)</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">files</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>  <span class="c1"># Retorna: [Path(&#39;src/main.py&#39;), Path(&#39;tests/test_main.py&#39;), ...]</span>
</code></pre></div>
<h4 id="analyzerpy-cerebro-da-analise">üß† <code>analyzer.py</code> - C√©rebro da An√°lise</h4>
<p>Analisa c√≥digo Python para detectar padr√µes de seguran√ßa:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CodeAnalyzer</span><span class="p">:</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Motor de an√°lise est√°tica de seguran√ßa.&quot;&quot;&quot;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">AuditResult</span><span class="p">]:</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Analisa um arquivo e retorna lista de findings.&quot;&quot;&quot;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        <span class="c1"># 1. L√™ conte√∫do do arquivo</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>        <span class="c1"># 2. Valida sintaxe com AST</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>        <span class="c1"># 3. Busca padr√µes de seguran√ßa linha a linha</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        <span class="c1"># 4. Verifica supress√µes (# noqa: &lt;categoria&gt;)</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="c1"># 5. Evita falsos positivos (coment√°rios, strings literais)</span>
</code></pre></div>
<p><strong>Intelig√™ncia Implementada:</strong></p>
<ul>
<li><strong>Valida√ß√£o AST:</strong> Garante que o arquivo √© Python v√°lido antes de analisar.</li>
<li><strong>Detec√ß√£o de Supress√µes:</strong> Respeita <code># noqa: S605</code> para ignorar warnings justificados.</li>
<li><strong>Filtragem de Falso Positivos:</strong></li>
<li>Ignora linhas de coment√°rio (<code># import os</code>)</li>
<li>Ignora strings literais (<code>"subprocess.run"</code>)</li>
<li><strong>Sugest√µes Contextualizadas:</strong> Gera recomenda√ß√µes espec√≠ficas para cada padr√£o.</li>
</ul>
<p><strong>Exemplo de An√°lise:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Arquivo: src/dangerous.py</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># ‚ùå DETECTADO: shell=True</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># Resultado:</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">AuditResult</span><span class="p">(</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="n">file</span><span class="o">=</span><span class="s2">&quot;src/dangerous.py&quot;</span><span class="p">,</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>    <span class="n">line</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">SecuritySeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>    <span class="n">category</span><span class="o">=</span><span class="s2">&quot;subprocess&quot;</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Shell injection risk detected&quot;</span><span class="p">,</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    <span class="n">code</span><span class="o">=</span><span class="s2">&quot;subprocess.run([&#39;ls&#39;], shell=True)&quot;</span><span class="p">,</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Use shell=False with list arguments&quot;</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="p">)</span>
</code></pre></div>
<h4 id="reporterpy-formatador-de-relatorios">üìä <code>reporter.py</code> - Formatador de Relat√≥rios</h4>
<p>Gera relat√≥rios estruturados em JSON/YAML:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ReportGenerator</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Gera relat√≥rios em m√∫ltiplos formatos.&quot;&quot;&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>        <span class="n">findings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AuditResult</span><span class="p">],</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gera relat√≥rio estruturado.&quot;&quot;&quot;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        <span class="c1"># Se√ß√µes:</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="c1"># - metadata (timestamp, workspace, arquivos varridos)</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        <span class="c1"># - findings (lista de vulnerabilidades)</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>        <span class="c1"># - summary (distribui√ß√£o por severidade, status)</span>
</code></pre></div>
<p><strong>Estrutura do Relat√≥rio:</strong></p>
<ul>
<li><strong>Metadata:</strong> Informa√ß√µes contextuais (timestamp, workspace, dura√ß√£o)</li>
<li><strong>Findings:</strong> Lista completa de vulnerabilidades detectadas</li>
<li><strong>Summary:</strong> Estat√≠sticas agregadas e recomenda√ß√µes</li>
</ul>
<h4 id="pluginspy-sistema-de-extensibilidade">üîå <code>plugins.py</code> - Sistema de Extensibilidade</h4>
<p>An√°lises especializadas modulares:</p>
<ul>
<li><strong><code>check_mock_coverage()</code></strong>: Verifica cobertura de mocks em testes</li>
<li><strong><code>simulate_ci()</code></strong>: Simula ambiente CI/CD local</li>
</ul>
<p><strong>Vantagem da Separa√ß√£o:</strong></p>
<ul>
<li>‚úÖ Plugins podem ser desabilitados individualmente</li>
<li>‚úÖ Novos plugins n√£o modificam o core (<code>analyzer.py</code>)</li>
<li>‚úÖ Testes isolados para cada plugin</li>
</ul>
<h3 id="fluxo-de-execucao">Fluxo de Execu√ß√£o</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>graph TB
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    A[CLI: dev-audit] --&gt; B[config.py: Load YAML]
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    B --&gt; C[scanner.py: Discover Files]
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    C --&gt; D[analyzer.py: Analyze Each File]
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    D --&gt; E[reporter.py: Generate Report]
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    E --&gt; F[plugins.py: Optional Extensions]
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    F --&gt; G[Output: JSON/YAML Report]
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    style A fill:#e1f5ff
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    style D fill:#fff4e1
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    style G fill:#c8e6c9
</code></pre></div>
<h3 id="beneficios-da-modularizacao">Benef√≠cios da Modulariza√ß√£o</h3>
<table>
<thead>
<tr>
<th><strong>Antes (Mon√≥lito)</strong></th>
<th><strong>Depois (Modular)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>‚ùå 700+ linhas em um arquivo</td>
<td>‚úÖ 6 m√≥dulos com ~100-200 linhas cada</td>
</tr>
<tr>
<td>‚ùå Dificuldade para testar isoladamente</td>
<td>‚úÖ Testes unit√°rios por m√≥dulo</td>
</tr>
<tr>
<td>‚ùå Mudan√ßas arriscadas (tudo acoplado)</td>
<td>‚úÖ Mudan√ßas cir√∫rgicas (SRP)</td>
</tr>
<tr>
<td>‚ùå Extens√£o requer editar core</td>
<td>‚úÖ Extens√£o via plugins (OCP)</td>
</tr>
<tr>
<td>‚ùå Imports e responsabilidades misturadas</td>
<td>‚úÖ Separa√ß√£o clara de conceitos</td>
</tr>
</tbody>
</table>
<h3 id="referencias-tecnicas">Refer√™ncias T√©cnicas</h3>
<ul>
<li><strong>Implementa√ß√£o:</strong> <a href="../../scripts/audit/">scripts/audit/</a></li>
<li><strong>Testes:</strong> <code>tests/test_audit_analyzer.py</code>, <code>tests/test_audit_memory.py</code></li>
<li><strong>Documenta√ß√£o do Processo:</strong> <a href="../../history/sprint_1_foundation/P12_CODE_AUDIT_REFACTORING_ANALYSIS/">docs/history/sprint_1_foundation/P12_CODE_AUDIT_REFACTORING_ANALYSIS.md</a></li>
<li><strong>Protocolo de Refatora√ß√£o:</strong> <a href="../../guides/REFACTORING_PROTOCOL_ITERATIVE_FRACTIONATION/">docs/guides/REFACTORING_PROTOCOL_ITERATIVE_FRACTIONATION.md</a></li>
</ul>
<hr />
<h2 id="features">üîç Features</h2>
<ul>
<li><strong>Security Pattern Detection</strong>: Identifies dangerous patterns like <code>shell=True</code>, <code>os.system()</code>, and code injection risks</li>
<li><strong>External Dependency Analysis</strong>: Detects unmocked external services that can cause CI/CD failures</li>
<li><strong>Mock Coverage Analysis</strong>: Ensures proper mocking of external dependencies in tests</li>
<li><strong>CI Environment Simulation</strong>: Runs tests in CI-like conditions to catch environment-specific issues</li>
<li><strong>Configurable Rules</strong>: YAML-based configuration for custom security patterns and scan settings</li>
<li><strong>Multiple Output Formats</strong>: JSON and YAML report generation</li>
<li><strong>Pre-commit Integration</strong>: Seamless integration with git pre-commit hooks</li>
<li><strong>DevOps Best Practices</strong>: Follows enterprise security and maintainability standards</li>
</ul>
<h2 id="quick-start">üöÄ Quick Start</h2>
<h3 id="basic-usage">Basic Usage</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Run basic security audit</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>dev-audit
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># Use custom configuration</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>dev-audit<span class="w"> </span>--config<span class="w"> </span>scripts/audit_config.yaml
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># Generate YAML report</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>dev-audit<span class="w"> </span>--output<span class="w"> </span>yaml
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c1"># Fail on medium severity issues</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>dev-audit<span class="w"> </span>--fail-on<span class="w"> </span>MEDIUM
</code></pre></div>
<h2 id="security-patterns-detected">üìã Security Patterns Detected</h2>
<h3 id="critical-severity">Critical Severity</h3>
<ul>
<li><code>os.system()</code> - Command injection vulnerability</li>
<li><code>shell=True</code> - Shell injection risk in subprocess calls</li>
<li><code>eval()</code> - Code injection vulnerability</li>
<li><code>exec()</code> - Code execution vulnerability</li>
</ul>
<h3 id="high-severity">High Severity</h3>
<ul>
<li><code>subprocess.run()</code> without proper validation</li>
<li><code>subprocess.call()</code> without proper validation</li>
<li>Socket connections without mocking</li>
<li><code>pickle.loads()</code> - Arbitrary code execution risk</li>
</ul>
<h3 id="medium-severity">Medium Severity</h3>
<ul>
<li>HTTP requests without mocking (<code>requests.*</code>, <code>httpx.*</code>, <code>urllib.*</code>)</li>
<li>Network operations in tests</li>
</ul>
<h3 id="low-severity">Low Severity</h3>
<ul>
<li>File operations without proper error handling</li>
</ul>
<h2 id="catalogo-de-plugins-disponiveis">üîå Cat√°logo de Plugins Dispon√≠veis</h2>
<p>O sistema de auditoria possui plugins modulares para an√°lises especializadas. Plugins s√£o fun√ß√µes que estendem as capacidades de auditoria sem modificar o core.</p>
<h3 id="plugin-check_mock_coverage">Plugin: <code>check_mock_coverage</code></h3>
<p><strong>M√≥dulo:</strong> <code>scripts/audit/plugins.py</code>
<strong>Fun√ß√£o:</strong> An√°lise de cobertura de mocks em testes</p>
<p><strong>Prop√≥sito:</strong>
Verifica se arquivos de teste est√£o mockando corretamente depend√™ncias externas (HTTP, subprocess, filesystem, etc.).</p>
<p><strong>Assinatura:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_mock_coverage</span><span class="p">(</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="n">workspace_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">scan_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze test files for proper mocking of external dependencies.&quot;&quot;&quot;</span>
</code></pre></div>
<p><strong>Retorno:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p">{</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="s2">&quot;total_test_files&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="s2">&quot;files_with_mocks&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="s2">&quot;files_needing_mocks&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>        <span class="s2">&quot;tests/test_api.py&quot;</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="s2">&quot;tests/integration/test_db.py&quot;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="p">]</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Indicadores de Mock Detectados:</strong></p>
<ul>
<li><code>@patch</code> (unittest.mock)</li>
<li><code>Mock()</code> (cria√ß√£o de mocks)</li>
<li><code>mocker.patch</code> (pytest-mock)</li>
<li><code>mock_</code> (prefixo de vari√°veis)</li>
<li><code>pytest-httpx</code> (mocks HTTP)</li>
<li><code>httpx_mock</code> (fixture httpx)</li>
</ul>
<p><strong>Indicadores de Depend√™ncia Externa:</strong></p>
<ul>
<li><code>requests.*</code> - Chamadas HTTP</li>
<li><code>httpx.*</code> - Cliente HTTP ass√≠ncrono</li>
<li><code>subprocess.*</code> - Execu√ß√£o de comandos</li>
<li><code>socket.*</code> - Conex√µes de rede</li>
</ul>
<p><strong>Uso:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scripts.audit.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_mock_coverage</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">coverage</span> <span class="o">=</span> <span class="n">check_mock_coverage</span><span class="p">(</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">workspace_root</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/projeto&quot;</span><span class="p">),</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">scan_paths</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tests/&quot;</span><span class="p">,</span> <span class="s2">&quot;src/&quot;</span><span class="p">]</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="p">)</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cobertura: </span><span class="si">{</span><span class="n">coverage</span><span class="p">[</span><span class="s1">&#39;files_with_mocks&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">coverage</span><span class="p">[</span><span class="s1">&#39;total_test_files&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Casos de Uso:</strong></p>
<ul>
<li>‚úÖ Valida√ß√£o de CI/CD (detectar testes inst√°veis)</li>
<li>‚úÖ Code review automatizado</li>
<li>‚úÖ An√°lise de qualidade de testes</li>
<li>‚úÖ Migra√ß√£o de testes legados</li>
</ul>
<hr />
<h3 id="plugin-simulate_ci">Plugin: <code>simulate_ci</code></h3>
<p><strong>M√≥dulo:</strong> <code>scripts/audit/plugins.py</code>
<strong>Fun√ß√£o:</strong> Simula√ß√£o de ambiente CI/CD local</p>
<p><strong>Prop√≥sito:</strong>
Executa testes em ambiente simulado de CI/CD, replicando condi√ß√µes (vari√°veis de ambiente, timeouts, isolamento) para detectar problemas antes do push.</p>
<p><strong>Assinatura:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">simulate_ci</span><span class="p">(</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="n">workspace_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="n">ci_timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate CI environment by running critical tests.&quot;&quot;&quot;</span>
</code></pre></div>
<p><strong>Retorno:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">{</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="s2">&quot;exit_code&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="s2">&quot;passed&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="s2">&quot;stdout&quot;</span><span class="p">:</span> <span class="s2">&quot;===== 42 passed in 1.23s =====&quot;</span><span class="p">,</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="s2">&quot;stderr&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="s2">&quot;within_timeout&quot;</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Vari√°veis de Ambiente Injetadas:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">ci_env</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>    <span class="s2">&quot;CI&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="s2">&quot;PYTEST_TIMEOUT&quot;</span><span class="p">:</span> <span class="s2">&quot;60&quot;</span><span class="p">,</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="c1"># Vari√°veis sens√≠veis s√£o REMOVIDAS (sanitize_env)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Flags pytest Usadas:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>pytest<span class="w"> </span>--tb<span class="o">=</span>short<span class="w"> </span>--maxfail<span class="o">=</span><span class="m">5</span><span class="w"> </span>--timeout<span class="o">=</span><span class="m">60</span><span class="w"> </span>--quiet<span class="w"> </span>tests/
</code></pre></div>
<p><strong>Seguran√ßa:</strong></p>
<ul>
<li>‚úÖ <strong>Sanitiza√ß√£o de ambiente:</strong> Credenciais e tokens s√£o removidos via <code>sanitize_env()</code></li>
<li>‚úÖ <strong>Shell injection prevention:</strong> <code>shell=False</code> sempre</li>
<li>‚úÖ <strong>Timeout enforcement:</strong> Previne testes infinitos</li>
<li>‚úÖ <strong>Isolamento:</strong> Executa em subprocess separado</li>
</ul>
<p><strong>Uso:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scripts.audit.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">simulate_ci</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">simulate_ci</span><span class="p">(</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="n">workspace_root</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/projeto&quot;</span><span class="p">),</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="n">ci_timeout</span><span class="o">=</span><span class="mi">300</span>  <span class="c1"># 5 minutos</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="p">)</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;passed&quot;</span><span class="p">]:</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå CI falhou: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;stderr&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Casos de Uso:</strong></p>
<ul>
<li>‚úÖ Pre-commit hook (detectar falhas antes do push)</li>
<li>‚úÖ Valida√ß√£o local de pipelines CI/CD</li>
<li>‚úÖ Debug de testes flaky</li>
<li>‚úÖ Verifica√ß√£o de isolamento de testes</li>
</ul>
<p><strong>C√≥digos de Erro:</strong></p>
<ul>
<li><code>0</code>: Sucesso (todos os testes passaram)</li>
<li><code>-1</code>: Timeout (testes excederam limite)</li>
<li><code>-2</code>: pytest n√£o instalado</li>
<li><code>-3</code>: Erro de execu√ß√£o (OSError)</li>
</ul>
<hr />
<h3 id="desenvolvendo-novos-plugins">Desenvolvendo Novos Plugins</h3>
<p><strong>Template de Plugin:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># scripts/audit/plugins.py</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">meu_plugin</span><span class="p">(</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    <span class="n">workspace_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Descri√ß√£o do plugin.</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="sd">    Args:</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="sd">        workspace_root: Raiz do projeto</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="sd">        config: Configura√ß√£o do audit_config.yaml</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="sd">    Returns:</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="sd">        Dicion√°rio com resultados da an√°lise</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Executando meu_plugin...&quot;</span><span class="p">)</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>    <span class="c1"># Implementa√ß√£o</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">}</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
<p><strong>Integra√ß√£o com CLI:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># scripts/cli/audit.py</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scripts.audit.plugins</span><span class="w"> </span><span class="kn">import</span> <span class="n">meu_plugin</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># Executar plugin</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">result</span> <span class="o">=</span> <span class="n">meu_plugin</span><span class="p">(</span><span class="n">workspace_root</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>
<p><strong>Best Practices:</strong></p>
<ul>
<li>‚úÖ Use logging estruturado (<code>logger.info/warning/error</code>)</li>
<li>‚úÖ Retorne sempre um dicion√°rio tipado</li>
<li>‚úÖ Documente par√¢metros e retorno (docstring)</li>
<li>‚úÖ Trate exce√ß√µes gracefully (try/except)</li>
<li>‚úÖ Adicione testes em <code>tests/test_audit_plugins.py</code></li>
</ul>
<hr />
<h2 id="configuration">‚öôÔ∏è Configuration</h2>
<p>The auditor uses a YAML configuration file (<code>audit_config.yaml</code>) to customize:</p>
<ul>
<li><strong>Scan Paths</strong>: Directories to include in the audit</li>
<li><strong>File Patterns</strong>: File extensions to scan</li>
<li><strong>Exclude Paths</strong>: Directories to skip</li>
<li><strong>Security Patterns</strong>: Custom patterns to detect</li>
<li><strong>Severity Levels</strong>: Classification of findings</li>
<li><strong>Mock Indicators</strong>: Patterns that indicate proper mocking</li>
</ul>
<p>Example configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nt">scan_paths</span><span class="p">:</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;src/&quot;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;tests/&quot;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;scripts/&quot;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="nt">file_patterns</span><span class="p">:</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*.py&quot;</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="nt">exclude_paths</span><span class="p">:</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;.git/&quot;</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;__pycache__/&quot;</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;.venv/&quot;</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="nt">ci_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="nt">max_findings_per_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="nt">custom_patterns</span><span class="p">:</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;eval(&quot;</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">    </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CRITICAL&quot;</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;eval()</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">detected</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">potential</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">injection&quot;</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;injection&quot;</span>
</code></pre></div>
<h2 id="report-format">üìä Report Format</h2>
<p>The auditor generates comprehensive reports in JSON or YAML format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="p">{</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-10-31T10:00:00Z&quot;</span><span class="p">,</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="nt">&quot;workspace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/path/to/project&quot;</span><span class="p">,</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="nt">&quot;duration_seconds&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5</span><span class="p">,</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="nt">&quot;files_scanned&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="nt">&quot;auditor_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0.0&quot;</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">  </span><span class="nt">&quot;findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">      </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;src/utils.py&quot;</span><span class="p">,</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">      </span><span class="nt">&quot;line&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">      </span><span class="nt">&quot;severity&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HIGH&quot;</span><span class="p">,</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">      </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subprocess&quot;</span><span class="p">,</span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Subprocess execution detected&quot;</span><span class="p">,</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">      </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subprocess.run(user_command, shell=True)&quot;</span><span class="p">,</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">      </span><span class="nt">&quot;suggestion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Use shell=False with list arguments&quot;</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">  </span><span class="nt">&quot;summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">    </span><span class="nt">&quot;total_findings&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">    </span><span class="nt">&quot;severity_distribution&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="w">      </span><span class="nt">&quot;CRITICAL&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="w">      </span><span class="nt">&quot;HIGH&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="w">      </span><span class="nt">&quot;MEDIUM&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="w">      </span><span class="nt">&quot;LOW&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="w">    </span><span class="nt">&quot;overall_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FAIL&quot;</span><span class="p">,</span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a><span class="w">    </span><span class="nt">&quot;recommendations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="w">      </span><span class="s2">&quot;üî¥ CRITICAL: Fix security vulnerabilities before commit&quot;</span><span class="p">,</span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="w">      </span><span class="s2">&quot;üß™ Add mocks to 3 test files&quot;</span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a><span class="w">    </span><span class="p">]</span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="p">}</span>
</code></pre></div>
<h2 id="command-line-options">üîß Command Line Options</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>dev-audit [OPTIONS]
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>Options:
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>  --config PATH         Path to configuration YAML file
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>  --output FORMAT       Output format: json, yaml (default: json)
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>  --report-file PATH    Custom report output path
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>  --quiet              Suppress console output
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>  --fail-on SEVERITY   Exit with error on severity level: CRITICAL, HIGH, MEDIUM, LOW
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>  --help               Show help message
</code></pre></div>
<h2 id="devops-integration">üèóÔ∏è DevOps Integration</h2>
<h3 id="cicd-pipeline-integration">CI/CD Pipeline Integration</h3>
<p>Add to your <code>.github/workflows/ci.yml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Audit</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="no">dev-audit --fail-on HIGH --output json</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Audit Report</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">  </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always()</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security-audit-report</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit_report_*.json</span>
</code></pre></div>
<h3 id="docker-integration">Docker Integration</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c"># Add to your Dockerfile for development images</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">COPY</span><span class="w"> </span>scripts/code_audit.py<span class="w"> </span>/app/scripts/
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>pyyaml
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="c"># Run audit during build</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="k">RUN</span><span class="w"> </span>dev-audit<span class="w"> </span>--fail-on<span class="w"> </span>CRITICAL
</code></pre></div>
<h2 id="security-best-practices">üõ°Ô∏è Security Best Practices</h2>
<p>The auditor enforces these security principles:</p>
<ol>
<li><strong>Input Validation</strong>: Detect unsafe user input handling</li>
<li><strong>Command Injection Prevention</strong>: Flag dangerous subprocess usage</li>
<li><strong>Dependency Isolation</strong>: Ensure external services are properly mocked</li>
<li><strong>Code Injection Prevention</strong>: Detect <code>eval()</code>, <code>exec()</code>, and similar risks</li>
<li><strong>Secure Defaults</strong>: Promote <code>shell=False</code> and safe coding patterns</li>
</ol>
<h2 id="performance">üìà Performance</h2>
<ul>
<li><strong>Fast Scanning</strong>: Processes ~1000 files/second</li>
<li><strong>Low Memory</strong>: Uses AST parsing for accuracy without high memory usage</li>
<li><strong>Configurable Limits</strong>: Prevents analysis paralysis with finding limits</li>
<li><strong>Early Exit</strong>: Stops on critical issues for fast feedback</li>
</ul>
<hr />
<h2 id="itens-auditados-e-resolvidos">üîê Itens Auditados e Resolvidos</h2>
<p>Esta se√ß√£o documenta vulnerabilidades identificadas e suas resolu√ß√µes.</p>
<h3 id="p002-atomicidade-do-pip-install">[P00.2] Atomicidade do Pip Install</h3>
<p><strong>Status:</strong> ‚úÖ Conclu√≠do (v8.0)
<strong>Data:</strong> 2025-12-06
<strong>Tipo:</strong> Estabilidade / SRE
<strong>Severidade:</strong> üî¥ Alta (corrup√ß√£o de ambiente de desenvolvimento)</p>
<p><strong>Problema Original:</strong></p>
<p>O script <code>scripts/cli/install_dev.py</code> realizava opera√ß√µes cr√≠ticas (<code>pip-compile</code>, <code>pip install</code>) sem garantia de atomicidade. Se o processo falhasse no meio, o arquivo <code>requirements/dev.txt</code> poderia ficar corrompido ou inconsistente, quebrando o ambiente para todos os desenvolvedores.</p>
<p><strong>Vulnerabilidades Identificadas:</strong></p>
<ol>
<li><strong>V1 - Aus√™ncia de Rollback (ALTA)</strong>: Se <code>pip install</code> falhasse ap√≥s <code>pip-compile</code>, o ambiente ficava em estado inconsistente</li>
<li><strong>V2 - Inconsist√™ncia no Fallback (M√âDIA)</strong>: Modo fallback n√£o usava mesmas valida√ß√µes do modo PATH</li>
<li><strong>V3 - Arquivos Tempor√°rios √ìrf√£os (BAIXA)</strong>: Cleanup incompleto em caso de exce√ß√£o</li>
</ol>
<p><strong>Solu√ß√£o Implementada:</strong></p>
<ol>
<li><strong>Backup Preemptivo</strong>: C√≥pia de seguran√ßa com preserva√ß√£o de metadados (<code>shutil.copy2</code>) antes da compila√ß√£o</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">backup_file</span> <span class="o">=</span> <span class="n">target_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.txt.bak&quot;</span><span class="p">)</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">target_file</span><span class="p">,</span> <span class="n">backup_file</span><span class="p">)</span>
</code></pre></div>
<ol>
<li><strong>Atomicidade</strong>: Uso de arquivos tempor√°rios validados para o <code>pip-compile</code></li>
<li>Valida√ß√£o de exist√™ncia do arquivo</li>
<li>Valida√ß√£o de tamanho (n√£o vazio)</li>
<li>Valida√ß√£o de sintaxe (header com coment√°rio)</li>
<li>
<p>Atomic replace usando <code>Path.replace()</code> (garantia POSIX)</p>
</li>
<li>
<p><strong>Rollback Autom√°tico</strong>: Bloco <code>try/except</code> que restaura o backup se a instala√ß√£o falhar</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;dev.txt&quot;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="n">backup_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">target_file</span><span class="p">)</span>  <span class="c1"># Restaura vers√£o anterior</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="k">raise</span>
</code></pre></div>
<ol>
<li><strong>UX Melhorada</strong>: Mensagem de erro refatorada para focar na prote√ß√£o</li>
<li><strong>Antes</strong>: <code>"‚ö†Ô∏è Installation failed. Rolled back: /path/to/dev.txt"</code></li>
<li>
<p><strong>Depois</strong>: <code>"üõ°Ô∏è ROLLBACK ATIVADO: A instala√ß√£o falhou, mas seu ambiente foi restaurado com seguran√ßa para a vers√£o anterior (dev.txt). Nenhuma altera√ß√£o foi aplicada."</code></p>
</li>
<li>
<p><strong>Cleanup Garantido</strong>: Remo√ß√£o de arquivos tempor√°rios ap√≥s sucesso</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">if</span> <span class="n">backup_file</span> <span class="ow">and</span> <span class="n">backup_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>    <span class="n">backup_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>  <span class="c1"># Remove .bak ap√≥s sucesso</span>
</code></pre></div>
<p><strong>Impacto:</strong></p>
<ul>
<li>‚úÖ Ambiente sempre em estado consistente</li>
<li>‚úÖ Rollback autom√°tico transparente</li>
<li>‚úÖ Redu√ß√£o de ansiedade do desenvolvedor</li>
<li>‚úÖ Menor necessidade de interven√ß√£o manual</li>
<li>‚úÖ Zero downtime em caso de falha</li>
</ul>
<p><strong>Arquivos Modificados:</strong></p>
<ul>
<li><code>scripts/cli/install_dev.py</code> (~95 linhas de mudan√ßa)</li>
</ul>
<p><strong>Refer√™ncias:</strong></p>
<ul>
<li>Relat√≥rio de Auditoria (Fase 01)</li>
<li>Relat√≥rio de Implementa√ß√£o (Fase 02)</li>
<li>Relat√≥rio de Refinamento de UX (Fase 03)</li>
</ul>
<h2 id="contributing">ü§ù Contributing</h2>
<p>When extending the auditor:</p>
<ol>
<li>Add new security patterns to <code>custom_patterns</code> in config</li>
<li>Follow the <code>SecurityPattern</code> class structure</li>
<li>Include severity classification and actionable suggestions</li>
<li>Add corresponding tests for new patterns</li>
<li>Update documentation with new capabilities</li>
</ol>
<h2 id="dependencies">üìö Dependencies</h2>
<ul>
<li><strong>Python 3.8+</strong>: Core language features and type hints</li>
<li><strong>PyYAML</strong>: Configuration file parsing</li>
<li><strong>Standard Library</strong>: AST, subprocess, pathlib, logging</li>
</ul>
<p>No heavy external dependencies - keeps the auditor lightweight and secure.</p>
<h2 id="troubleshooting">üîç Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<p><strong>"pytest not found"</strong>: Install pytest for CI simulation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>pip<span class="w"> </span>install<span class="w"> </span>pytest<span class="w"> </span>pytest-timeout
</code></pre></div>
<p><strong>"Config file not found"</strong>: Use absolute path or place config in scripts/</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>dev-audit<span class="w"> </span>--config<span class="w"> </span>/full/path/to/config.yaml
</code></pre></div>
<p><strong>"Too many findings"</strong>: Adjust <code>max_findings_per_file</code> in config</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nt">max_findings_per_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">  </span><span class="c1"># Reduce from default 50</span>
</code></pre></div>
<p><strong>"False positives"</strong>: Add exclusion patterns or adjust severity thresholds</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nt">exclude_paths</span><span class="p">:</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;tests/fixtures/&quot;</span><span class="w">  </span><span class="c1"># Exclude test fixtures</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;migrations/&quot;</span><span class="w">      </span><span class="c1"># Exclude database migrations</span>
</code></pre></div>
<h2 id="support">üìû Support</h2>
<p>For issues, feature requests, or questions:</p>
<ol>
<li>Check the configuration documentation</li>
<li>Review the troubleshooting section</li>
<li>Examine audit logs in <code>audit.log</code></li>
<li>Create an issue with audit report attached</li>
</ol>
<hr />
<h2 id="historico-de-melhorias">üìã Hist√≥rico de Melhorias</h2>
<h3 id="p29-hardening-de-dados-com-enums">[P29] Hardening de Dados com Enums</h3>
<p><strong>Status:</strong> ‚úÖ Conclu√≠do (v8.0)
<strong>Data:</strong> 2025-12-06
<strong>Tipo:</strong> Arquitetura / Seguran√ßa</p>
<p><strong>Problema Original:</strong></p>
<p>Modelos usavam strings soltas ("magic strings") para definir severidade e status. Erros de digita√ß√£o passavam despercebidos at√© o runtime.</p>
<p>Exemplo do problema:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1"># ‚ùå ANTES: Strings soltas permitiam erros silenciosos</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecurityIssue</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;HIHG&quot; (typo) seria aceito!</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">)</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_severity</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>        <span class="c1"># 30+ linhas de boilerplate para cada campo</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;LOW&quot;</span><span class="p">,</span> <span class="s2">&quot;MEDIUM&quot;</span><span class="p">,</span> <span class="s2">&quot;HIGH&quot;</span><span class="p">,</span> <span class="s2">&quot;CRITICAL&quot;</span><span class="p">]:</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid severity: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>        <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
<p><strong>Solu√ß√£o Implementada:</strong></p>
<ol>
<li>
<p><strong>Convers√£o de Campos para Enums</strong>: Todos os campos de dom√≠nio finito foram convertidos para <code>Enum</code> (herdando de <code>str</code> para compatibilidade JSON).</p>
</li>
<li>
<p><strong>Cria√ß√£o de Enums Espec√≠ficos</strong>:</p>
</li>
<li><code>SecurityCategory</code>: Categorias de vulnerabilidades (<code>INJECTION</code>, <code>CRYPTO</code>, <code>AUTH</code>, <code>XSS</code>)</li>
<li>
<p><code>SecuritySeverity</code>: N√≠veis de severidade (<code>LOW</code>, <code>MEDIUM</code>, <code>HIGH</code>, <code>CRITICAL</code>)</p>
</li>
<li>
<p><strong>Elimina√ß√£o de Validadores Manuais</strong>: Remo√ß√£o de 30+ linhas de c√≥digo boilerplate (validadores <code>@field_validator</code>).</p>
</li>
<li>
<p><strong>Cobertura de Tipagem Estrita</strong>: Testes atualizados para usar valores do Enum, garantindo type safety completo.</p>
</li>
</ol>
<p><strong>Exemplo da Solu√ß√£o:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c1"># ‚úÖ DEPOIS: Enums fornecem valida√ß√£o autom√°tica</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecuritySeverity</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Severity levels with automatic validation.&quot;&quot;&quot;</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;LOW&quot;</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;MEDIUM&quot;</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;HIGH&quot;</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;CRITICAL&quot;</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecurityIssue</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>    <span class="n">severity</span><span class="p">:</span> <span class="n">SecuritySeverity</span>  <span class="c1"># Typos detectados em tempo de an√°lise!</span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>    <span class="n">category</span><span class="p">:</span> <span class="n">SecurityCategory</span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>    <span class="c1"># Zero validadores manuais necess√°rios</span>
</code></pre></div>
<p><strong>Benef√≠cios Mensur√°veis:</strong></p>
<ul>
<li><strong>-30+ linhas de c√≥digo</strong>: Elimina√ß√£o de validadores boilerplate</li>
<li><strong>100% Type Safety</strong>: Mypy detecta erros antes do runtime</li>
<li><strong>Melhor DX</strong>: Autocomplete e valida√ß√£o autom√°tica na IDE</li>
<li><strong>Zero Regress√µes</strong>: Testes garantem compatibilidade JSON/YAML</li>
<li><strong>Documenta√ß√£o Expl√≠cita</strong>: Valores v√°lidos ficam vis√≠veis no c√≥digo</li>
</ul>
<p><strong>Impacto em Arquivos:</strong></p>
<ul>
<li><code>scripts/core/mock_ci/models.py</code>: Modelos de CI/CD</li>
<li><code>scripts/audit/models.py</code>: Modelos de auditoria</li>
<li><code>tests/test_*.py</code>: Testes atualizados com Enum values</li>
<li><code>docs/guides/ENGINEERING_STANDARDS.md</code>: Padr√£o documentado</li>
</ul>
<p><strong>Refer√™ncias:</strong></p>
<ul>
<li><a href="../../guides/ENGINEERING_STANDARDS/#enums-vs-magic-strings">ENGINEERING_STANDARDS.md - Enums vs Magic Strings</a></li>
<li>Sprint Issue: [P29] - Refatora√ß√£o Enum Completa</li>
</ul>
<hr />







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.top", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>