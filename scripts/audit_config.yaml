# Code Audit Configuration
# DevOps-grade security and quality auditing configuration

# Paths to scan for security issues
scan_paths:
  - "src/"
  - "tests/"

# File patterns to include in scan
file_patterns:
  - "*.py"

# Paths to exclude from scanning
exclude_paths:
  - ".git/"
  - "__pycache__/"
  - ".venv/"
  - "venv/"
  - ".pytest_cache/"
  - "node_modules/"
  - "dist/"
  - "build/"
  - "tests/test_audit_analyzer.py"  # Contém strings de vulnerabilidade intencionais para testes
  - "tests/test_mock_ci_runner_e2e.py"  # Usa subprocess.run para testes E2E - falso positivo
  - "tests/test_dependency_alignment.py"  # Usa subprocess.run para validar lockfiles - seguro
  - "tests/test_verify_deps.py"  # Usa subprocess.run para testes E2E - inputs validados e shell=False
  - "tests/test_security_audit.py"  # Usa subprocess.run em mocks de testes - seguro (shell=False)
  - "scripts/utils/safe_pip.py"  # Usa subprocess.run de forma controlada e segura (shell=False)
  - "scripts/cli/install_dev.py"  # Usa subprocess.run de forma segura (shell=False + validação)
  - "scripts/ci/verify_deps.py"  # Usa subprocess.run de forma segura (shell=False + validação) para pip-tools

# CI simulation timeout in seconds
ci_timeout: 300
simulate_ci: false

# Maximum findings per file to avoid noise
max_findings_per_file: 50

# Severity levels (in order of importance)
severity_levels:
  - "LOW"
  - "MEDIUM"
  - "HIGH"
  - "CRITICAL"

# Custom security patterns (advanced users)
custom_patterns:
  - pattern: "eval("
    severity: "CRITICAL"
    description: "eval() usage detected - potential code injection vulnerability"
    category: "injection"

  - pattern: "exec("
    severity: "CRITICAL"
    description: "exec() usage detected - potential code injection vulnerability"
    category: "injection"

  - pattern: "pickle.loads("
    severity: "HIGH"
    description: "pickle.loads() can execute arbitrary code - use json instead"
    category: "deserialization"

# Mock patterns to look for in tests
mock_indicators:
  - "@patch"
  - "Mock()"
  - "mocker.patch"
  - "mock_"
  - "pytest-httpx"
  - "httpx_mock"
  - "responses.add"
  - "unittest.mock"

# External service indicators that should be mocked
external_service_indicators:
  - "requests."
  - "httpx."
  - "urllib.request"
  - "subprocess."
  - "socket."
  - "os.system"
  - "smtplib."
  - "ftplib."

# Report settings
report:
  include_suggestions: true
  max_code_snippet_length: 80
  group_by_severity: true
  show_file_stats: true
