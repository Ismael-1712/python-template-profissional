---
id: vulnerability-policy
type: guide
status: active
version: 1.0.0
author: SRE Engineering Team
date: '2026-01-11'
context_tags: [security, sca, cve, pip-audit, vulnerability-management]
linked_code: []
title: üõ°Ô∏è Pol√≠tica de Gerenciamento de Vulnerabilidades (SCA)
---

# üõ°Ô∏è Pol√≠tica de Gerenciamento de Vulnerabilidades (SCA)

**Data:** 11 de Janeiro de 2026
**Status:** üü¢ Ativo
**Vers√£o:** v2.1 (Protocolo Triple Defense)

---

## üìã Vis√£o Geral

Este documento define os processos e pol√≠ticas para detec√ß√£o, triagem e resolu√ß√£o de vulnerabilidades em depend√™ncias Python usando **Software Composition Analysis (SCA)** via `pip-audit`.

**Objetivo:** Eliminar a janela de exposi√ß√£o a CVEs conhecidas, garantindo que NENHUMA vulnerabilidade passe despercebida por erro humano.

---

## üîí Arquitetura Triple Defense

O projeto implementa **3 camadas de prote√ß√£o** contra vulnerabilidades:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CAMADA 1: Pre-Commit Hook                  ‚îÇ
‚îÇ  ‚úì Bloqueio local antes de commit          ‚îÇ
‚îÇ  ‚úì Feedback imediato ao desenvolvedor       ‚îÇ
‚îÇ  ‚úì Executa apenas em mudan√ßas de deps      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CAMADA 2: Makefile Target                  ‚îÇ
‚îÇ  ‚úì Cache inteligente (SHA256 de lockfile)  ‚îÇ
‚îÇ  ‚úì Valida√ß√£o manual via `make validate`    ‚îÇ
‚îÇ  ‚úì Hard-fail em vulnerabilidades            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  CAMADA 3: CI/CD Pipeline                   ‚îÇ
‚îÇ  ‚úì Valida√ß√£o em cada Pull Request          ‚îÇ
‚îÇ  ‚úì Artefatos de auditoria (90 dias)        ‚îÇ
‚îÇ  ‚úì Bloqueia merge em caso de CVE           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üöÄ Comandos Dispon√≠veis

### Executar Auditoria Completa

```bash

make audit-security-sca

```

- Verifica `requirements/dev.txt` para CVEs conhecidas

- Usa cache inteligente (r√°pido se lockfile n√£o mudou)
- **Falha** se detectar vulnerabilidades n√£o ignoradas

### For√ßar Re-scan (Invalidar Cache)

```bash
rm -rf .cache/pip-audit-*
make audit-security-sca


```

### Executar Quality Gate Completo

```bash
make validate
```

- Inclui SCA como parte da valida√ß√£o obrigat√≥ria
- Executa lint, testes, type checking **e** auditoria de seguran√ßa

---

## üîç Processo de Triagem de CVE

### FASE 1: Detec√ß√£o Autom√°tica (0-5min)

Quando uma vulnerabilidade √© detectada, o sistema exibe:

```
‚ùå VULNERABILIDADES DETECTADAS! Revise .cache/pip-audit-XXXXX.json
üíä CORRE√á√ÉO: Atualize as depend√™ncias ou adicione exce√ß√µes em pyproject.toml

```

**A√ß√µes Imediatas:**

1. **Revise o relat√≥rio JSON:**

   ```bash
   cat .cache/pip-audit-*.json | jq '.vulnerabilities'
   ```

2. **Identifique a severidade:**
   - `CRITICAL` ‚Üí A√ß√£o imediata (0-2h)
   - `HIGH` ‚Üí A√ß√£o urgente (24h)
   - `MEDIUM` ‚Üí A√ß√£o planejada (7 dias)
   - `LOW` ‚Üí Backlog (30 dias)

### FASE 2: Decis√£o T√©cnica (2-24h)

| Condi√ß√£o | A√ß√£o Recomendada | Prazo |
|----------|------------------|-------|
| **Fix dispon√≠vel** | Atualizar depend√™ncia em `requirements/dev.in` | Imediato |
| **Exploit p√∫blico + CRITICAL** | Remover pacote ou downgrade tempor√°rio | 2h |
| **Sem fix + HIGH** | Aceitar risco documentado (ver abaixo) | 24h |
| **Fix em beta** | Testar vers√£o beta em ambiente isolado | 7 dias |
| **Depend√™ncia transitiva** | Atualizar pacote pai ou aguardar upstream | 14 dias |

### FASE 3: Resolu√ß√£o

#### Op√ß√£o A: Atualizar Depend√™ncia (Preferencial)

```bash
# 1. Editar requirements/dev.in
echo "requests>=2.31.0  # Fix CVE-2023-32681" >> requirements/dev.in

# 2. Recompilar lockfile
make requirements

# 3. Validar
make audit-security-sca

# 4. Commit
git add requirements/
git commit -m "security: fix CVE-2023-32681 in requests"
```

#### Op√ß√£o B: Aceitar Risco Documentado

**Crit√©rios para Aceita√ß√£o:**

1. ‚úÖ Sem fix dispon√≠vel **OU** fix causa breaking changes
2. ‚úÖ Mitiga√ß√µes implementadas no c√≥digo
3. ‚úÖ Justificativa t√©cnica documentada
4. ‚úÖ Data de expira√ß√£o definida (m√°ximo 90 dias)
5. ‚úÖ Aprova√ß√£o do Security Champion

**Processo:**

```toml
# pyproject.toml
[tool.pip-audit]
ignore-vulns = [
    "CVE-2026-XXXXX",  # chromadb - Sem fix dispon√≠vel (breaking changes na v2.x)
    # Justificativa: Migra√ß√£o para v2.x requer 3 sprints
    # Mitiga√ß√µes: Desabilitado acesso externo, valida√ß√£o de inputs
    # Expira: 2026-04-11 (90 dias)
    # Issue: #123
]
```

```markdown
<!-- Criar Issue no GitHub -->
## üîí Security Risk Acceptance: CVE-2026-XXXXX

**Vulnerability:** CVE-2026-XXXXX in chromadb==1.4.0
**Severity:** HIGH (CVSS 7.5)
**Status:** No fix available
**Expiration:** 2026-04-11 (90 days)

### Technical Justification
- chromadb 2.x has breaking API changes
- Migration requires 3 sprints
- Current usage is isolated to dev-only features

### Mitigations Implemented
- [x] Disabled external network access in chromadb config
- [x] Input validation on all queries
- [x] Monitoring for suspicious activity

### Acceptance Criteria
- Reviewed by: @security-champion
- Approved by: @tech-lead
- Next review: 2026-04-11
```

---

## üõ†Ô∏è Desenvolvimento Local

### Pulando Temporariamente o Hook (EMERG√äNCIAS APENAS)

```bash
# Use com EXTREMA cautela e documente no commit message

SKIP=pip-audit-sca git commit -m "hotfix: emergency deploy (CVE review pending)"
```

**‚ö†Ô∏è ATEN√á√ÉO:** O CI ainda validar√° a vulnerabilidade. Use apenas para commits urgentes que ser√£o corrigidos em seguida.

### Cache Local

O sistema mant√©m cache em `.cache/pip-audit-*.json` (SHA256 do lockfile).

**Invalida√ß√£o Autom√°tica:** Cache √© invalidado automaticamente quando `requirements/dev.txt` muda.

**Limpeza Manual:**

```bash
make clean  # Remove cache de pip-audit
```

---<https://pypi.org/project/pip-audit/>
<https://osv.dev/>

## üìä M√©tricas de Sucesso<https://github.com/advisories>

<https://nvd.nist.gov/>

- ‚úÖ **0 CVEs CRITICAL/HIGH** em produ√ß√£o
- ‚úÖ **< 8s overhead** no pre-commit hook (com cache)
- ‚úÖ **100% cobertura** de depend√™ncias (diretas + transitivas)
- ‚úÖ **< 5 min** para triagem d<https://pypi.org/project/pip-audit/>
- ‚úÖ **90 dias m√°ximo<https://osv.dev/>o de CVE aceita
<https://github.com/advisories>
---<https://nvd.nist.gov/>

## üîó Recursos Adicionais

- **PyPI Advisory Database:** <https://pypi.org/project/pip-audit/>
- **OSV Database:** <https://osv.dev/>
- **GitHub Security Advisories:** <https://github.com/advisories>
- **NIST NVD:** <https://nvd.nist.gov/>

---

## üìû Contato

**Security Champion:** @tech-lead
**Escala√ß√£o:** Abra Issue com label `security-critical`

---

**√öltima Atualiza√ß√£o:** 11 de Janeiro de 2026
**Pr√≥xima Revis√£o:** 11 de Abril de 2026 (90 dias)
